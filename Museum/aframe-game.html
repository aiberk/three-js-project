<html>
  <head>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script>
      //  TODO
      // - Create 3D Model
      // - Create hover,failure,and success animations
      // - Export to Gltf
      // - Add to Code
      // - Figure out Lights
      // - Figure out Camera
      // - Figure out Sound
    </script>
    <script>
      const chosen_box = Math.floor(Math.random() * 3);
      let click_count = 0;

      AFRAME.registerComponent("foo", {
        schema: {},
        init: function () {
          var data = this.data;
          var el = this.el;

          el.addEventListener("click", function () {
            el.setAttribute("animation-mixer", {
              clip: "pirate shipAction.007",
              loop: "repeat",
              repetitions: 2,
            });
            if (this.id == chosen_box) {
              alert("Wooo!");
            } else {
              console.log("Try again" + this.id);
            }
          });

          // UNCOMMENT THIS IS CRITICAL CODE
          // UNCOMMENT THIS IS CRITICAL CODE
          // UNCOMMENT THIS IS CRITICAL CODE
          // UNCOMMENT THIS IS CRITICAL CODE
          // el.addEventListener("mouseenter", function () {
          //   console.log(this.id + " is hovered.");
          //   var mesh = el.getObject3D("mesh");
          //   console.log(mesh);
          //   el.setAttribute("animation-mixer", {
          //     clip: "pirate shipAction.010",
          //     loop: "repeat",
          //     repetitions: 2,
          //   });

          //   // console.log("chil color=" + mesh.children[8].material.color.r);
          //   // mesh.material.opacity = 0.9;
          // });

          // el.addEventListener("mouseleave", function () {
          //   var mesh = el.getObject3D("mesh");
          //   el.setAttribute("animation-mixer", {
          //     clip: "pirate shipAction.007",
          //     loop: "repeat",
          //     repetitions: 2,
          //   });
          // });
          // UNCOMMENT THIS IS CRITICAL CODE
          // UNCOMMENT THIS IS CRITICAL CODE
          // UNCOMMENT THIS IS CRITICAL CODE
          // UNCOMMENT THIS IS CRITICAL CODE
        },
        update: function (oldData) {
          this.el = this.data;
        },
        tick: function () {},
        remove: function () {},
        pause: function () {},
        play: function () {},
      });

      AFRAME.registerComponent("message", {
        schema: { value: "Chest Game" },
        init: function () {
          var data = this.data;
          var el = this.el;

          el.addEventListener("click", function () {});
        },
        update: function (oldData) {
          this.el = this.data;
        },
        tick: function () {},
        remove: function () {},
        pause: function () {},
        play: function () {},
      });
    </script>
  </head>
  <body>
    <a-scene id="container">
      <a-assets>
        <a-asset-item id="suzy-gltf" src="assets/chest.glb"></a-asset-item>
      </a-assets>

      <a-entity
        id="camera"
        camera="userHeight: 1.6"
        look-controls
        cursor="rayOrigin: mouse"
      ></a-entity>

      <a-text
        message
        value="Chest Game"
        scale=""
        position="-0.6 0.58877 -2"
        rotation=""
        id="main-text"
        text=""
      ></a-text>

      <a-entity
        foo
        id="0"
        gltf-model="#suzy-gltf"
        position="-2.5 -1.407 -4.151"
        scale="1.5 1.5 1.5"
        rotation="0 -89.60716141168997 0"
      ></a-entity>

      <a-entity
        foo
        id="1"
        gltf-model="#suzy-gltf"
        position="-1 -1.407 -4.151"
        scale="1.5 1.5 1.5"
        rotation="0 -89.60716141168997 0"
      ></a-entity>

      <a-entity
        foo
        id="2"
        gltf-model="assets/chest.glb"
        position="0.5 -1.407 -4.151"
        scale="1.5 1.5 1.5"
        rotation="0 -89.60716141168997 0"
      ></a-entity>

      <a-sky color="#FFCCAA"></a-sky>
    </a-scene>
  </body>
</html>
