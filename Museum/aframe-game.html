<html>
  <head>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <scrip
      src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"
    ></scrip>
    <script>
      const chosen_box = Math.floor(Math.random() * 3);
      let click_count = 0;

      AFRAME.registerComponent("foo", {
        schema: {},
        init: function () {
          var data = this.data;
          var el = this.el;

          el.addEventListener("click", function () {
            if (this.id == chosen_box) {
              alert("Wooo!");
            } else {
              console.log("Try again" + this.id);
            }
          });

          //Idea is to change color or lighting when hovered
          //First change material -> then add lights
          el.addEventListener("mouseenter", function () {
            console.log(this.id + " is hovered.");
            var mesh = el.getObject3D("mesh");
            console.log(mesh);
            mesh.scale.x = 1.1;
            mesh.scale.y = 1.1;
            mesh.scale.z = 1.1;

            // console.log("chil color=" + mesh.children[8].material.color.r);
            // mesh.material.opacity = 0.9;
          });

          el.addEventListener("mouseleave", function () {
            // console.log(this.id + " is hovered.");
            var mesh = el.getObject3D("mesh");
            // mesh.material.opacity = 1;
            mesh.scale.x = 1;
            mesh.scale.y = 1;
            mesh.scale.z = 1;
          });
        },
        update: function (oldData) {
          this.el = this.data;
        },
        tick: function () {},
        remove: function () {},
        pause: function () {},
        play: function () {},
      });

      AFRAME.registerComponent("message", {
        schema: { value: "Chest Game" },
        init: function () {
          var data = this.data;
          var el = this.el;

          el.addEventListener("click", function () {});
        },
        update: function (oldData) {
          this.el = this.data;
        },
        tick: function () {},
        remove: function () {},
        pause: function () {},
        play: function () {},
      });
    </script>
  </head>
  <body>
    <a-scene id="container">
      <a-assets>
        <a-asset-item id="suzy-obj" src="assets/chest0.obj"></a-asset-item>
        <a-asset-item id="suzy-gltf" src="assets/chest.glb"></a-asset-item>
      </a-assets>

      <a-assets>
        <a-asset-item
          id="drone"
          src="assets/mech_drone/scene.gltf"
        ></a-asset-item>
      </a-assets>

      <a-entity
        id="camera"
        camera="userHeight: 1.6"
        look-controls
        cursor="rayOrigin: mouse"
      ></a-entity>

      <a-text
        message
        value="Chest Game"
        scale=""
        position="-0.6 0.58877 -2"
        rotation=""
        id="main-text"
        text=""
      ></a-text>

      <a-entity
        position="0 2 -9"
        gltf-model="#drone"
        scale="0.02 0.02 0.02"
        animation="property: rotation; dur: 10000;
                       to: 0 360 0; loop: true"
      >
      </a-entity>

      <a-entity
        animation-mixer
        id="0"
        material=""
        gltf-model="assets/mech_drone/scene.gltf"
        position="-2.5 -1.407 -4.151"
        scale="1.5 1.5 1.5"
        rotation="0 -89.60716141168997 0"
      ></a-entity>

      <a-entity
        foo
        id="1"
        gltf-model="#suzy-gltf"
        position="-1 -1.407 -4.151"
        scale="1.5 1.5 1.5"
        rotation="0 -89.60716141168997 0"
      ></a-entity>

      <a-entity
        foo
        id="2"
        gltf-model="assets/chest.glb"
        position="0.5 -1.407 -4.151"
        scale="1.5 1.5 1.5"
        rotation="0 -89.60716141168997 0"
      ></a-entity>

      <a-sky color="#FFCCAA"></a-sky>
    </a-scene>
  </body>
</html>
